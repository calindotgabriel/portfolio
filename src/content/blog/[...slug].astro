---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: post,
  }));
}

const post = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title}>
  <article class="blog-post">
    <header>
      <h1>{post.data.title}</h1>
      <p class="description">{post.data.description}</p>
      <div class="meta">
        <time>{post.data.publishDate.toLocaleDateString()}</time>
        <span>by {post.data.author}</span>
      </div>
    </header>

    <Content />

    <footer>
      <div class="tags">
        {post.data.tags.map((tag) => <span class="tag">{tag}</span>)}
      </div>

      <div class="cta">
        <h3>Need help with similar challenges?</h3>
        <p>I help European companies migrate to modern architectures.</p>
        <a href="/contact" class="cta-button">Schedule a consultation</a>
      </div>
    </footer>
  </article>
</Layout>

<style>
  .blog-post {
    max-width: 800px;
    margin: 0 auto;
    padding: 2rem;
  }

  .blog-post header {
    margin-bottom: 3rem;
    text-align: center;
  }

  .description {
    font-size: 1.2rem;
    color: #718096;
    margin: 1rem 0;
  }

  .meta {
    font-size: 0.9rem;
    color: #a0aec0;
  }

  .cta {
    background: #f7fafc;
    padding: 2rem;
    border-radius: 8px;
    text-align: center;
    margin-top: 3rem;
  }
</style>
